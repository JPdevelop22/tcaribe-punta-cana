const travels = 
{
    "pickups": 
    {
        "Hoteles Bavaro Punta Cana": 
        {
            "name-ES": "Hoteles de la zona Bavaro, Punta Cana",
            "name-EN": "Hotels in Bavaro, Punta Cana area",
            "stops": [],
            "destiny-ES": ["PUJ"],
            "destiny-EN": ["PUJ"],
            "tracks": 2,
            "passengers": ["1 - 6", "7 - 21", "22 - 33", "34 - 45", "46 - 54", "55 - 59"] 			

        },

        "Hoteles Uvero Alto": 
        {
            "name-ES": "Hoteles en Uvero Alto",
            "name-EN": "Hotels in Uvero Alto",
            "stops": [],
            "destiny-ES": ["PUJ", "La Romana", "Boca Chica-Aila"],
            "destiny-EN": ["PUJ", "La Romana", "Boca Chica-Aila"],
            "tracks": 2,
            "passengers": ["1 - 6", "7 - 21", "22 - 33", "34 - 45", "46 - 54", "55 - 59"]			

        },

        "Hoteles Higuey": 
        { 
            "name-ES": "Hoteles en Higüey",
            "name-EN": "Hotels in Higüey",
            "stops": [],
            "destiny-ES": ["PUJ"],
            "destiny-EN": ["PUJ"],
            "tracks": 2,
            "passengers": ["1 - 6", "7 - 21", "22 - 33", "34 - 45", "46 - 54", "55 - 59"]			

        },

        "Hoteles Bayahibe": 
        {
            "name-ES": "Hoteles en Bayahíbe",
            "name-EN": "Hotels in Bayahíbe",
            "stops": [],
            "destiny-ES": ["PUJ"],
            "destiny-EN": ["PUJ"],
            "tracks": 2,
            "passengers": ["1 - 6", "7 - 21", "22 - 33", "34 - 45", "46 - 54", "55 - 59"]			

        },	

        "Hoteles La Romana": 
        { 
            "name-ES": "Hoteles en La Romana",
            "name-EN": "Hotels in La Romana",
            "stops": [],
            "destiny-ES": ["PUJ"],
            "destiny-EN": ["PUJ"],
            "tracks": 2,
            "passengers": ["1 - 6", "7 - 21", "22 - 33", "34 - 45", "46 - 54", "55 - 59"]			

        },	

        "Hoteles Santana": 
        {
            "name-ES": "Hoteles en Santana Play.n",
            "name-EN": "Hotels in Santana Play.n",
            "stops": ["La Romana"],
            "destiny-ES": ["PUJ"],
            "destiny-EN": ["PUJ"],
            "tracks": 2,
            "passengers": ["1 - 6", "7 - 21", "22 - 33", "34 - 45", "46 - 54", "55 - 59"]			

        },

        "Hoteles Juan Dolio": 
        {
            "name-ES": "Hoteles en Juan Dolio",
            "name-EN": "Hotels in Juan Dolio",
            "stops": [],
            "destiny-ES": ["PUJ"],
            "destiny-EN": ["PUJ"],
            "tracks": 2,
            "passengers": ["1 - 6", "7 - 21", "22 - 33", "34 - 45", "46 - 54", "55 - 59"]			

        },	
    
        "Hoteles Boca Chica": {
            "name-ES": "Hoteles en Boca Chica",
            "name-EN": "Hotels in Boca Chica",
            "stops": [],
            "destiny-ES": ["PUJ"],
            "destiny-EN": ["PUJ"],
            "tracks": 2,
            "passengers": ["1 - 6", "7 - 21", "22 - 33", "34 - 45", "46 - 54", "55 - 59"]			

        },

        "Hoteles Santo Domingo": 
        {
            "name-ES": "Hoteles en Santo Domingo",
            "name-EN": "Hotels in Santo Domingo",
            "stops": [],
            "destiny-ES": ["PUJ"],
            "destiny-EN": ["PUJ"],
            "tracks": 2,
            "passengers": ["1 - 6", "7 - 21", "22 - 33", "34 - 45", "46 - 54", "55 - 59"]			

        },

        "Hoteles Santiago": 
        {
            "name-ES": "Hoteles en Santiago",
            "name-EN": "Hotels in Santiago",
            "stops": [],
            "destiny-ES": ["PUJ"],
            "destiny-EN": ["PUJ"],
            "tracks": 1,
            "passengers": ["1 - 6", "7 - 21", "22 - 33"] 			

        },

        "Hoteles Puerto Plata": 
        {
            "name-ES": "Hoteles en Puerto Plata",
            "name-EN": "Hotels in Puerto Plata",
            "stops": [],
            "destiny-ES": ["PUJ"],
            "destiny-EN": ["PUJ"],
            "tracks": 1,
            "passengers": ["1 - 6", "7 - 21", "22 - 33", "34 - 45", "46 - 54", "55 - 59"]			

        },

        "Hoteles Samana": 
        {
            "name-ES": "Hoteles en Samaná",
            "name-EN": "Hotels in Samaná",
            "stops": [],
            "destiny-ES": ["PUJ"],
            "destiny-EN": ["PUJ"],
            "tracks": 1,
            "passengers": ["1 - 6", "7 - 21", "22 - 33"] 			

        },

        "Hoteles Sabana de la Mar": 
        {
            "name-ES": "Hoteles en Sabana de la Mar",
            "name-EN": "Hotels in Sabana de la Mar",
            "stops": [],
            "destiny-ES": ["PUJ"],
            "destiny-EN": ["PUJ"],
            "tracks": 2,
            "passengers": ["1 - 6", "7 - 21", "22 - 33", "34 - 45", "46 - 54", "55 - 59"]			

        },

        "PUJ": 
        {
            "name-ES": "Aeropuerto Internacional de Punta Cana",
            "name-EN": "Punta Cana Internacional airport",
            "stops": [],
            "destiny-ES": ["Hoteles de la zona Bavaro, Punta Cana", "Hoteles en Uvero Alto", "Hoteles in La Romana", "San Pedro de Macorís", "El Seibo", "Boca Chica", "Santo Domingo", "Santiago", "Samaná", "Puerto Plata"],
            "destiny-EN": ["Hotels in Bavaro, Punta Cana area", "Hotels in Uvero Alto", "Hotels in La Romana", "San Pedro de Macorís", "El Seibo", "Boca Chica", "Santo Domingo", "Santiago", "Samaná", "Puerto Plata"],
            "tracks": 2,
            "passengers": ["1 - 6", "7 - 21", "22 - 33", "34 - 45", "46 - 54", "55 - 59"]			
        } 
    }
}

const pickups = Object.values(travels.pickups)

const drawPickupsSelect = (pickups) => {
    $("#startContainer").html(
        '<label for="pickUpPoints">Punto de recogida</label>' +
        '<select name="pickUpPoints" id="pickUpPoints" required>' +
            '<option value=""></option>' +
        '</select>'        
    )

    pickups.forEach((pickup) => {
        let optionValue = `${pickup["name-ES"]} . ${pickup["stops"]} . ${pickup["destiny-ES"]} . ${pickup["tracks"]} . ${pickup["passengers"]}`
        $('#pickUpPoints').append(
            `<option value="${optionValue}">${pickup["name-ES"]}</option>`
        )
    })
}

const drawTracksSelect = (tracks) => {
    $("#tracksContainer").html(
        '<label for="tracks">Punto de recogida</label>' +
        '<select name="tracks" id="tracks" required>' +
            '<option value="1">1 via</option>' +
        '</select>'        
    )

    if (tracks > 1) {
        for (let i = 2; i <= tracks; i++) {
            $('#tracks').append(
                `<option value="${i}">${i} vias</option>`
            )
        }
    }
}

const drawStopsSelect = (stops) => {
    $("#stopContainer").html(
        '<label for="stops">Punto de parada</label>' +
        '<select name="stops" id="stops" required>' +
            '<option value=""></option>' +
        '</select>'        
    )

    stops.forEach(stop => {
        $('#stops').append(
            `<option value="${stop}">${stop}</option>`
        )
    })
}

const removeStopSelect = () => $('#stopContainer').empty()

const drawDestinySelect = (destinies) => {
    $("#destinyContainer").html(
        '<label for="destinies">Destino</label>' +
        '<select name="destinies" id="destinies" required>' +
            '<option value=""></option>' +
        '</select>'        
    )

    destinies.forEach(destiny => {
        $('#destinies').append(
            `<option value="${destiny}">${destiny}</option>`
        )
    })
}

const drawPassengersSelect = (passgersCount) => {
    $("#passengersContainer").html(
        '<label for="passengers">Pasajeros</label>' +
        '<select name="passengers" id="passengers" required>' +
            '<option value=""></option>' +
        '</select>'        
    )

    passgersCount.forEach(passengers => {
        $('#passengers').append(
            `<option value="${passengers}">De ${passengers} pasajeros</option>`
        )
    })
}

$(document).ready(() => {
    $('#bookType').on('change', (e) => {
        if (e.target.value === 'viaje turistico') {
            drawPickupsSelect(pickups)
        }
        console.log("changing...")
    })
    
    $('#startContainer').on('change', '#pickUpPoints', (e) => {
        const [name, stops, destiny, tracks, passengers] = e.target.value.split(' . ')

        drawTracksSelect(tracks)

        if (stops) {
            drawStopsSelect(stops.split(","))
        } else {
            removeStopSelect()
        }

        console.log(destiny)
        drawDestinySelect(destiny.split(","))

        console.log(passengers)
        drawPassengersSelect(passengers.split(","))
    })

    $('#bookForm').on('submit', (e) => {
        e.preventDefault()

        let message
        if (e.target.stops) {
            message = 
                e.target.bookType.value + ' | ' +
                e.target.tracks.value + ' | ' +
                e.target.pickUpPoints.value + ' | ' +
                e.target.stops.value + ' | ' +
                e.target.destinies.value + ' | ' +
                e.target.bookDate.value + ' | ' +
                e.target.passengers.value
        } else {
            message = 
                e.target.bookType.value + ' | ' +
                e.target.tracks.value + ' | ' +
                e.target.pickUpPoints.value + ' | ' +
                e.target.destinies.value + ' | ' +
                e.target.bookDate.value + ' | ' +
                e.target.passengers.value
        }

        console.log(message)
    })

})

